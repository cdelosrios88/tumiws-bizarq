<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- 
/************************************************************************/
/* Nombre de componente: session */
/* Descripción: Componente mapeador de objetos entre la clase Session y la tabla 
		SEG_V_SESSION de BD   */
/* Cod. Req.: REQ14-002   */
/* Autor : Christian De los Ríos */
/* Versión : V1 */
/* Fecha creación : 30/07/2014 */
/* ********************************************************************* */
-->

<sqlMap namespace="SessionDaoIbatis">

  <typeAlias type="pe.com.tumi.seguridad.login.domain.Session" alias="SessionUser"/>
  <!-- Inicio: REQ14-003 - bizarq - 10/08/2014 -->
  <typeAlias type="pe.com.tumi.seguridad.login.domain.SessionDB" alias="SessionDB"/>
  <typeAlias type="pe.com.tumi.seguridad.login.domain.composite.SessionComp" alias="SessionComp"/>
  <!-- Fin: REQ14-003 - bizarq - 10/08/2014 -->
  
  <resultMap id="resSessionUser" class="SessionUser" >
     <result property="id.intPersEmpresaPk"      	column="pPers_empresa_n_pk" />
     <result property="id.intPersPersonaPk"  		column="pPers_persona_n_pk" />
     <result property="id.intSessionPk"      		column="pSess_idsession_n_pk" />
     <result property="tsFechaRegistro"   			column="pSess_fecharegistro_d" />
     <result property="tsFechaTermino" 				column="pSess_fechatermino_d" />
     <result property="intIdSucursal"   			column="pSess_idsucursal_n" />
     <result property="intInAccesoRemoto"  			column="pSess_accesoremoto_n" />
     <result property="intIdEstado"  				column="pSess_idestadosession_n" />
     <result property="intIdWebSession"  			column="pSess_idwebsession_n" />
     <result property="intIdBDSession"  			column="pSess_sid_v" />
     <result property="strMacAddress"  				column="pSess_macaddress_v" />
     <result property="intIndCabina"  				column="pSess_indcabina_n" />
  </resultMap>
   
  <resultMap id="resSessionDB" class="SessionDB" >
     <result property="strSID"      		column="pSID_V" />
     <result property="strSerial"  			column="pSERIAL_V" />
     <result property="strUserName"      	column="pPCUSER_V" />
     <result property="strBdUser"   		column="pBDUSER_V" />
     <result property="strTypeLock" 		column="pTYPELOCK_V" />
     <result property="strProcessLocker"   	column="pPROCESS_LOCKER_V" />
     <result property="strSchemaName"  		column="pSCHEMA_V" />
     <result property="strObjectName"  		column="pOBJECT_NAME_V" />
     <result property="strObjectType"  		column="pOBJECT_TYPE_V" />
     <result property="strProgram"  		column="pPROGRAM_V" />
     <result property="strOwner"  			column="pOWNER_V" />
     <result property="strSqlQuery"  		column="pSQL_QUERY_V" />
     <result property="strMachine"  		column="pMACHINE_V" />
     <result property="strSqlId"  			column="pSQLID_V" />
  </resultMap>
  
  <resultMap id="resSessionComp" class="SessionComp" >
     <result property="session.id.intSessionPk"    	column="pSess_idsession_n_pk" />
     <result property="session.id.intPersPersonaPk" column="pIdPersonaPk" />
     <result property="strFullName"      			column="pFullName_V" />
     <result property="session.intIdEstado"   		column="pSess_idestadosession_n" />
     <result property="session.id.intPersEmpresaPk" column="pPers_empresa_n_pk" />
     <result property="strEmpresa"   				column="pPers_razonsocial_v" />
     <result property="strEmpresaSiglas"  			column="pPers_siglas_v" />
     <result property="session.intIdSucursal"  		column="pPers_sucursal_n_pk" />
     <result property="strSucursal"  				column="pSucursal_v" />
     <result property="strSucursalSiglas"  			column="pSiglasSucursal_v" />
     <result property="session.tsFechaRegistro"  	column="pSess_fecharegistro_d" />
     <result property="session.tsFechaTermino"		column="pSess_fechatermino_d" />
     <result property="session.strMacAddress"  		column="pSess_macaddress_v" />
  </resultMap>
   
  <parameterMap id="parSessionUser" class="SessionUser">
     <parameter property="id.intPersEmpresaPk"		jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
	 <parameter property="id.intPersPersonaPk"		jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
	 <parameter property="id.intSessionPk"			jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
     <parameter property="tsFechaRegistro"			jdbcType="TIMESTAMP"  	javaType="java.sql.Timestamp" 	mode="INOUT"/>
     <parameter property="tsFechaTermino"			jdbcType="TIMESTAMP"  	javaType="java.sql.Timestamp" 	mode="INOUT"/>
     <parameter property="intIdSucursal"			jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
     <parameter property="intInAccesoRemoto"		jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
	 <parameter property="intIdEstado"				jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>    
     <parameter property="intIdWebSession" 			jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="INOUT"/>
     <parameter property="intIdBDSession" 			jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="INOUT"/>
     <parameter property="strMacAddress" 			jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="INOUT"/>
     <parameter property="intIndCabina" 			jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="INOUT"/>
  </parameterMap>
  
  <parameterMap id="parPorActiveSession" class="java.util.Map">
	 <parameter property="intPersPersonaPk"			jdbcType="NUMERIC"  	javaType="java.lang.Integer" 	mode="IN"/>
	 <parameter property="intEscalar" 				jdbcType="NUMERIC" 		javaType="java.lang.Integer"	mode="OUT"/>
  </parameterMap>
  
  <parameterMap id="parPorUserPK" class="java.util.Map">
   	 <parameter property="cursorLista" 			jdbcType="ORACLECURSOR"  javaType="java.sql.ResultSet" 	mode="OUT"/>
   	 <parameter property="intPersPersonaPk" 	jdbcType="NUMERIC"		 javaType="java.lang.Integer"  	mode="IN"/>
  </parameterMap>
  
  <!-- Inicio: REQ14-003 - bizarq - 10/08/2014 -->
  
  <parameterMap id="parPorPK" class="java.util.Map">
   	 <parameter property="cursorLista" 			jdbcType="ORACLECURSOR"  javaType="java.sql.ResultSet" 	mode="OUT"/>
   	 <parameter property="intSessionPk" 		jdbcType="NUMERIC"		 javaType="java.lang.Integer"  	mode="IN"/>
  </parameterMap>
  
  <parameterMap id="parPorSessionWeb" class="java.util.Map">
   	 <parameter property="cursorLista" 			jdbcType="ORACLECURSOR"  javaType="java.sql.ResultSet" 	mode="OUT"/>
   	 <parameter property="intIdEmpresa" 		jdbcType="NUMERIC"		 javaType="java.lang.Integer"  	mode="IN"/>
   	 <parameter property="intIdSucursal" 		jdbcType="NUMERIC"		 javaType="java.lang.Integer"  	mode="IN"/>
   	 <parameter property="strFullName" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
   	 <parameter property="tsFechaRegistro" 		jdbcType="TIMESTAMP"	 javaType="java.sql.Timestamp"  mode="IN"/>
   	 <parameter property="tsFechaTermino" 		jdbcType="TIMESTAMP"	 javaType="java.sql.Timestamp"  mode="IN"/>
   	 <parameter property="intIdEstado" 			jdbcType="NUMERIC"		 javaType="java.lang.Integer"  	mode="IN"/>
  </parameterMap>
  
  <parameterMap id="parPorBlockBD" class="java.util.Map">
   	 <parameter property="cursorLista" 			jdbcType="ORACLECURSOR"  javaType="java.sql.ResultSet" 	mode="OUT"/>
   	 <parameter property="strSchema" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
   	 <parameter property="strProgram" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
   	 <parameter property="strObject" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
  </parameterMap>
  
  
  <parameterMap id="parPorSessionBD" class="java.util.Map">
   	 <parameter property="cursorLista" 			jdbcType="ORACLECURSOR"  javaType="java.sql.ResultSet" 	mode="OUT"/>
   	 <parameter property="strSchema" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
   	 <parameter property="strProgram" 			jdbcType="VARCHAR"		 javaType="java.lang.String"  	mode="IN"/>
  </parameterMap>
  
  <parameterMap id="parPorkillBlockDB" class="java.util.Map">
	 <parameter property="strSID"				jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="IN"/>
	 <parameter property="strSerial"			jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="IN"/>
	 <parameter property="intEscalar" 			jdbcType="NUMERIC" 		javaType="java.lang.Integer"	mode="OUT"/>
  </parameterMap>
  
  <parameterMap id="parPorkillSessionDB" class="java.util.Map">
	 <parameter property="strSID"				jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="IN"/>
	 <parameter property="strSerial"			jdbcType="VARCHAR"  	javaType="java.lang.String" 	mode="IN"/>
	 <parameter property="intEscalar" 			jdbcType="NUMERIC" 		javaType="java.lang.Integer"	mode="OUT"/>
  </parameterMap>
  <!-- Fin: REQ14-003 - bizarq - 10/08/2014 -->
  
  <procedure id="grabar" parameterMap="parSessionUser">
	{ call PKG_SESSION.grabar(?,?,?,?,?,?,?,?,?,?,?,?) }
  </procedure>
  
  <procedure id="modificar" parameterMap="parSessionUser" >
	{ call PKG_SESSION.modificar(?,?,?,?,?,?,?,?,?,?,?,?) }
  </procedure>
  
  <procedure id="getActiveSessionByUser" parameterMap="parPorActiveSession">
	{ call PKG_SESSION.getValidSessionByUser(?,?) }
  </procedure>
  
  <procedure id="getListByUser" parameterMap="parPorUserPK" resultMap="resSessionUser">
	{ call PKG_SESSION.getListByUser(?,?) }
  </procedure>
  
  <!-- Inicio: REQ14-003 - bizarq - 10/08/2014 -->
  <procedure id="getListaPorPk" parameterMap="parPorPK" resultMap="resSessionUser">
	{ call PKG_SESSION.getListaPorPK(?,?) }
  </procedure>
  
  <procedure id="getListaSessionWeb" parameterMap="parPorSessionWeb" resultMap="resSessionComp">
	{ call PKG_SESSION.getListSessionWeb(?,?,?,?,?,?,?) }
  </procedure>
  
  <procedure id="getListBlockDB" parameterMap="parPorBlockBD" resultMap="resSessionComp">
	{ call PKG_SESSION.getListBlockDB(?,?,?,?) }
  </procedure>
  
  <procedure id="getListSessionDB" parameterMap="parPorSessionBD" resultMap="resSessionDB">
	{ call PKG_SESSION.getListSessionDB(?,?,?) }
  </procedure>
  
  <procedure id="killBlockDB" parameterMap="parPorkillBlockDB">
	{ call PKG_SESSION.killBlockDB(?,?,?) }
  </procedure>
  
  <procedure id="killSessionDB" parameterMap="parPorkillSessionDB">
	{ call PKG_SESSION.killSessionDB(?,?,?) }
  </procedure>
  <!-- Fin: REQ14-003 - bizarq - 10/08/2014 -->
</sqlMap>  